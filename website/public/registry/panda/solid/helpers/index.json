{
  "files": [
    {
      "filename": "create-style-context.tsx",
      "content": "import { createContext, useContext, type ComponentProps, type ValidComponent } from 'solid-js'\nimport { Dynamic } from 'solid-js/web'\n\ntype GenericProps = Record<string, unknown>\ntype StyleRecipe = {\n  (props: GenericProps): Record<string, string>\n  splitVariantProps: (props: GenericProps) => any\n}\n\ntype PolymorphicProps<T extends ValidComponent, P = ComponentProps<T>> = {\n  [K in keyof P]: P[K]\n}\n\nexport const createStyleContext = <R extends StyleRecipe>(recipe: R) => {\n  const StyleContext = createContext<Record<string, string> | null>(null)\n\n  const withProvider = <T extends ValidComponent>(Component: T, slot?: string) => {\n    const StyledComponent = (props: PolymorphicProps<T> & Parameters<R>[0]) => {\n      const [variantProps, componentProps] = recipe.splitVariantProps(props)\n      const styleProperties = recipe(variantProps)\n      return (\n        <StyleContext.Provider value={styleProperties}>\n          <Dynamic\n            component={Component}\n            class={styleProperties?.[slot ?? '']}\n            {...componentProps}\n          />\n        </StyleContext.Provider>\n      )\n    }\n    return StyledComponent\n  }\n\n  const withContext = <T extends ValidComponent>(Component: T, slot?: string): T => {\n    if (!slot) return Component\n    const StyledComponent = (props: PolymorphicProps<T>) => {\n      const styles = useContext(StyleContext)\n      return <Dynamic component={Component} {...props} class={styles?.[slot ?? '']} />\n    }\n    return StyledComponent as T\n  }\n\n  return {\n    withProvider,\n    withContext,\n  }\n}\n"
    }
  ]
}
